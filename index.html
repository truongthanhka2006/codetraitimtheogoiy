<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Crystal Pink Heart - Fast Pulse</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #050505; }
        canvas { display: block; }
    </style>
</head>
<body>
<canvas id="heartCanvas"></canvas>
<script>
const canvas = document.getElementById('heartCanvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
const particleCount = 8000;
let time = 0;

function getHeartPoint(t){
    return {
        x: 16*Math.pow(Math.sin(t),3),
        y: -(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))
    };
}

class Particle{
    constructor(){
        this.init();
    }

    init(){
        this.t = Math.random() * Math.PI * 2;
        const point = getHeartPoint(this.t);

        const modifier = Math.pow(Math.random(), 0.25);
        const spread = modifier * 18;

        this.baseX = point.x * spread;
        this.baseY = point.y * spread;

        this.size = Math.random()*0.6+0.2;
        this.color = '#ff69b4';
        this.baseOpacity = Math.random()*0.4 + 0.2;
        this.opacity = this.baseOpacity;
        this.vantage = modifier;
    }

    draw(pulse){
        const x = canvas.width/2 + this.baseX * pulse;
        const y = canvas.height/2 + this.baseY * pulse;

        ctx.globalAlpha = this.opacity * Math.pow(this.vantage,2);
        ctx.fillStyle = this.color;

        ctx.beginPath();
        ctx.arc(x,y,this.size,0,Math.PI*2);
        ctx.fill();
    }

    update(pulseStrength){
        // Nhấp nháy mạnh theo nhịp tim
        this.opacity = this.baseOpacity + pulseStrength*0.5;
        if(this.opacity>1) this.opacity=1;
    }
}

function init(){
    particles = [];
    for(let i=0;i<particleCount;i++){
        particles.push(new Particle());
    }
}

function render(){
    ctx.fillStyle = 'rgba(5,5,5,0.12)'; // nền mờ để lưu ảnh mượt
    ctx.fillRect(0,0,canvas.width,canvas.height);

    time += 0.2; // tốc độ nhịp tim nhanh
    // Tạo nhịp tim kiểu “dồn dập”: hai nhịp gần nhau, rồi nghỉ
    const beat1 = Math.pow(Math.sin(time),8);
    const beat2 = Math.pow(Math.sin(time+0.3),8);
    const pulseStrength = beat1 + beat2;

    const pulse = 1 + pulseStrength*0.3; // co giãn mạnh hơn

    particles.forEach(p=>{
        p.update(pulseStrength);
        p.draw(pulse);
    });

    requestAnimationFrame(render);
}

window.addEventListener('resize',()=>{
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    init();
});

init();
render();
</script>
</body>
</html>
